(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,t){e.exports="data:image/png;base64,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"},138:function(e,t,n){e.exports=n.p+"static/media/star.c42c34a7.png"},139:function(e,t,n){e.exports=n.p+"static/media/iconSidebar.cb272010.png"},167:function(e,t,n){e.exports=n(300)},278:function(e,t,n){},279:function(e,t,n){},290:function(e,t,n){},291:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},294:function(e,t,n){},295:function(e,t,n){},299:function(e,t,n){},300:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(131),c=n(16),s=n(14),i=n(133),l=n(130),m=n(15),u={isAuthenticated:!1,willAuthenticate:!0,currentUser:{},socket:null},p=n(28),d={all:[],currentUserRooms:[]},h=(n(175),{channel:null,currentRoom:{},messages:[],presentUsers:[],loadingOlderMessages:!1,pagination:{total_pages:0,total_entries:0,page_size:0,page_number:0}}),g=Object(s.c)({form:l.a,session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;switch(console.log(t.type),t.type){case"AUTHENTICATION_REQUEST":return Object(m.a)({},e,{willAuthenticate:!0});case"AUTHENTICATION_SUCCESS":return Object(m.a)({},e,{willAuthenticate:!1,isAuthenticated:!0,currentUser:t.response.data});case"AUTHENTICATION_FAILURE":return Object(m.a)({},e,{willAuthenticate:!1});case"LOGOUT":return Object(m.a)({},e,{willAuthenticate:!1,isAuthenticated:!1,currentUser:{},socket:null});case"SOCKET_CONNECTED":return Object(m.a)({},e,{socket:t.socket});default:return e}},rooms:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_ROOMS_SUCCESS":return Object(m.a)({},e,{all:t.response.data});case"FETCH_USER_ROOMS_SUCCESS":return Object(m.a)({},e,{currentUserRooms:t.response.data});case"CREATE_ROOM_SUCCESS":return Object(m.a)({},e,{all:[t.response.data].concat(Object(p.a)(e.all)),currentUserRooms:[].concat(Object(p.a)(e.currentUserRooms),[t.response.data])});case"ROOM_JOINED":return Object(m.a)({},e,{currentUserRooms:[].concat(Object(p.a)(e.currentUserRooms),[t.response.data])});default:return e}},room:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(console.log("REDUE >>>> "+e.currentRoom.id),t.type){case"ROOM_CONNECTED_TO_CHANNEL":return Object(m.a)({},e,{channel:t.channel,currentRoom:t.response.room,messages:t.response.messages.reverse(),pagination:t.response.pagination});case"USER_LEFT_ROOM":return h;case"MESSAGE_CREATED":return Object(m.a)({},e,{messages:[].concat(Object(p.a)(e.messages),[t.message])});case"ROOM_PRESENCE_UPDATE":return console.log("Room presnce update"),Object(m.a)({},e,{presentUsers:t.presentUsers});case"FETCH_MESSAGES_REQUEST":return Object(m.a)({},e,{loadingOlderMessages:!0});case"FETCH_MESSAGES_SUCCESS":return Object(m.a)({},e,{messages:[].concat(Object(p.a)(t.response.data.reverse()),Object(p.a)(e.messages)),pagination:t.response.pagination,loadingOlderMessages:!1});case"FETCH_MESSAGES_FAILURE":return Object(m.a)({},e,{loadingOlderMessages:!1});default:return e}}}),b=Object(s.d)(function(e,t){return"LOGOUT"===t.type?g(void 0,t):g(e,t)},Object(s.a)(i.a)),f=n(8),E=n(9),v=n(11),O=n(10),y=n(12),j=n(302),S=n(303),A=n(304),C=n(301),R=function(){return r.a.createElement("div",{style:{margin:"2rem auto",textAlign:"center"}},r.a.createElement("p",null,"Page not found"),r.a.createElement("p",null,r.a.createElement(C.a,{to:"/"},"Go to the home page \u2192")))},k=n(13),x=k.a.create({navbar:{display:"flex",alignItems:"center",padding:"0 1rem",height:"70px",background:"#fff",boxShadow:"0 1px 1px rgba(0,0,0,.1)"},link:{color:"#555459",fontSize:"22px",fontWeight:"bold",":hover":{textDecoration:"none"},":focus":{textDecoration:"none"}}}),U=function(){return r.a.createElement("nav",{className:Object(k.b)(x.navbar)},r.a.createElement(C.a,{to:"/",className:Object(k.b)(x.link)},"Slackclone"))},w="http://localhost:4000/api";function N(){var e=JSON.parse(localStorage.getItem("token"));return{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer: ".concat(e)}}function M(e){return e.json().then(function(t){return e.ok?t:Promise.reject(t)})}var T={fetch:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch("".concat(w).concat(e).concat(function(e){var t=Object.keys(e).map(function(t){return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(e[t]))}).join("&");return"".concat(t.length?"?":"").concat(t)}(t)),{method:"GET",headers:N()}).then(M)}),post:function(e,t){var n=JSON.stringify(t);return fetch("".concat(w).concat(e),{method:"POST",headers:N(),body:n}).then(M)},patch:function(e,t){var n=JSON.stringify(t);return fetch("".concat(w).concat(e),{method:"PATCH",headers:N(),body:n}).then(M)},delete:function(e){return fetch("".concat(w).concat(e),{method:"DELETE",headers:N()}).then(M)}};function I(e,t){return function(n){return T.post("/rooms/".concat(e,"/join")).then(function(e){n({type:"ROOM_JOINED",response:e}),t.push("/r/".concat(e.data.id))})}}var D=function(e){var t=e.room,n=e.currentUserRoomIds,a=e.onRoomJoin,o=n.includes(t.id);return r.a.createElement("div",{key:t.id,style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"}},r.a.createElement("span",{style:{marginRight:"8px"}},t.name),r.a.createElement("button",{onClick:function(){return a(t.id)},className:"btn btn-sm",disabled:o},o?"Joined":"Join"))},L=n(128),_=n(129),H=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){return n.props.onSubmit(e)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.submitting;return r.a.createElement("form",{onSubmit:t(this.handleSubmit)},r.a.createElement("div",{className:"input-group"},r.a.createElement(L.a,{name:"name",type:"text",placeholder:"Name",component:"input",className:"form-control"}),r.a.createElement("div",{className:"input-group-btn"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:n},n?"Saving...":"Submit"))))}}]),t}(a.Component),F=Object(_.a)({form:"newRoom",validate:function(e){var t={};return e.name?e.name.length>24&&(t.name="Must be less than 18 characters"):t.name="Required",t}})(H),J=k.a.create({card:{maxWidth:"500px",padding:"3rem 4rem",margin:"2rem auto"}}),G=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleNewRoomSubmit=function(e){return n.props.createRoom(e,n.props.history)},n.handleRoomJoin=function(e){return n.props.joinRoom(e,n.props.history)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchRooms()}},{key:"renderRooms",value:function(){var e=this,t=[];return this.props.currentUserRooms.map(function(e){return t.push(e.id)}),this.props.rooms.map(function(n){return r.a.createElement(D,{key:n.id,room:n,onRoomJoin:e.handleRoomJoin,currentUserRoomIds:t})})}},{key:"render",value:function(){return r.a.createElement("div",{style:{flex:"1"}},r.a.createElement(U,null),r.a.createElement("div",{className:"card ".concat(Object(k.b)(J.card))},r.a.createElement("h3",{style:{marginBottom:"2rem",textAlign:"center"}},"Create a new room"),r.a.createElement(F,{onSubmit:this.handleNewRoomSubmit})),r.a.createElement("div",{className:"card ".concat(Object(k.b)(J.card))},r.a.createElement("h3",{style:{marginBottom:"2rem",textAlign:"center"}},"Join a room"),this.renderRooms()))}}]),t}(a.Component),B=Object(c.b)(function(e){return{rooms:e.rooms.all,currentUserRooms:e.rooms.currentUserRooms}},{fetchRooms:function(){return function(e){return T.fetch("/rooms").then(function(t){e({type:"FETCH_ROOMS_SUCCESS",response:t})})}},createRoom:function(e,t){return function(n){return T.post("/rooms",e).then(function(e){n({type:"CREATE_ROOM_SUCCESS",response:e}),t.push("/r/".concat(e.data.id))})}},joinRoom:I})(G),W=n(22),Z=n(40),P=n(141),z=function(e,t){var n=[];Z.Presence.list(t,function(e,t){return Object(P.a)(t.metas,1)[0].user}).map(function(e){return n.push(e)}),e({type:"ROOM_PRESENCE_UPDATE",presentUsers:n})};var Y="http://localhost:4000/api".replace(/(https|http)/,"ws").replace("/api","");function V(e,t){var n;localStorage.setItem("token",JSON.stringify(t.meta.token)),e({type:"AUTHENTICATION_SUCCESS",response:t}),e((n=t.data.id,function(e){return T.fetch("/users/".concat(n,"/rooms")).then(function(t){e({type:"FETCH_USER_ROOMS_SUCCESS",response:t})})})),function(e){var t=JSON.parse(localStorage.getItem("token")),n=new Z.Socket("".concat(Y,"/socket"),{params:{token:t},logger:function(e,t,n){console.log("".concat(e,": ").concat(t),n)}});n.connect(),e({type:"SOCKET_CONNECTED",socket:n})}(e)}var X=function(e){var t=e.input,n=e.label,a=e.type,o=e.placeholder,c=e.style,s=e.meta;return r.a.createElement("div",{style:{marginBottom:"1rem"}},n&&r.a.createElement("label",{htmlFor:t.name},n),r.a.createElement("input",Object.assign({},t,{type:a,placeholder:o,className:"form-control",style:c&&c})),s.touched&&s.error&&r.a.createElement("div",{style:{fontSize:"85%",color:"rgb(255,59,48)"}},s.error))},Q=k.a.create({card:{maxWidth:"500px",padding:"3rem 4rem",margin:"2rem auto"}}),K=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){return n.props.onSubmit(e)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.submitting;return r.a.createElement("form",{className:"card ".concat(Object(k.b)(Q.card)),onSubmit:t(this.handleSubmit)},r.a.createElement("h3",{style:{marginBottom:"2rem",textAlign:"center"}},"Login to Sling"),r.a.createElement(L.a,{name:"email",type:"text",component:X,placeholder:"Email"}),r.a.createElement(L.a,{name:"password",type:"password",component:X,placeholder:"Password"}),r.a.createElement("button",{type:"submit",disabled:n,className:"btn btn-block btn-primary"},n?"Logging in...":"Login"),r.a.createElement("hr",{style:{margin:"2rem 0"}}),r.a.createElement(C.a,{to:"/signup",className:"btn btn-block btn-secondary"},"Create a new account"))}}]),t}(a.Component),q=Object(_.a)({form:"login",validate:function(e){var t={};return e.email||(t.email="Required"),e.password||(t.password="Required"),t}})(K),$=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).componentDidMount=function(){},n.handleLogin=function(e){return n.props.login(e,n.props.history)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{flex:"1"}},r.a.createElement(U,null),r.a.createElement(q,{onSubmit:this.handleLogin}))}}]),t}(a.Component),ee=Object(c.b)(null,{login:function(e,t){return function(n){return T.post("/sessions",e).then(function(e){V(n,e),n(Object(W.a)("login")),t.push("/r/1")})}}})($),te=(n(278),function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(v.a)(this,Object(O.a)(t).call(this))).handleClick=function(t){e.props.onClick(t.currentTarget.src),t.currentTarget.className="avatar-selected"},e.state={isSelected:""},e}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this,t=["186720","186693","186742","186711","186726","186722","186721","186709","186700","186695","186702","186684","186677","186717","186710","186707"];return r.a.createElement("div",{className:"avatar-grid"},t.map(function(n){return r.a.createElement("img",{key:t.indexOf(n),src:"https://image.flaticon.com/icons/png/128/186/"+n+".png",className:"avatar",onClick:e.handleClick})}))}}]),t}(a.Component)),ne=(n(279),k.a.create({card:{maxWidth:"500px",padding:"3rem 4rem",margin:"2rem auto"}}),function(e){function t(e){var n;return Object(f.a)(this,t),(n=Object(v.a)(this,Object(O.a)(t).call(this,e))).handleSubmit=function(e){e.image=n.state.image,n.props.onSubmit(e)},n.addAvatar=function(e){n.setState({image:e})},n.state={image:"https://f4.bcbits.com/img/a0069281785_10.jpg"},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=e.submitting;return r.a.createElement("div",{className:"login-form"},r.a.createElement(te,{onClick:this.addAvatar}),r.a.createElement("form",{className:"card",onSubmit:t(this.handleSubmit)},r.a.createElement("h3",{style:{marginBottom:"2rem",textAlign:"center"}},"Create an account"),r.a.createElement(L.a,{name:"username",type:"text",component:X,placeholder:"Username",className:"form-control"}),r.a.createElement(L.a,{name:"email",type:"email",component:X,placeholder:"Email",className:"form-control"}),r.a.createElement(L.a,{name:"password",type:"password",component:X,placeholder:"Password",className:"form-control"}),r.a.createElement("button",{type:"submit",disabled:n,className:"btn btn-block btn-primary"},n?"Submitting...":"Sign up"),r.a.createElement("hr",{style:{margin:"2rem 0"}}),r.a.createElement(C.a,{to:"/login",className:"btn btn-block btn-secondary"},"Login to your account")))}}]),t}(a.Component)),ae=Object(_.a)({form:"signup",validate:function(e){var t={};return e.username?e.username.length>18&&(t.username="Required"):t.username="Required",e.email||(t.email="Required"),e.password?e.password.length<6&&(t.password="Minimum of 6 characters"):t.password="Required",t}})(ne),re=n(140),oe=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleSignup=function(e){n.props.signup(e,n.props.history)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{flex:"1"}},r.a.createElement(U,null),r.a.createElement(ae,{onSubmit:this.handleSignup}))}}]),t}(a.Component),ce=Object(re.a)(Object(c.b)(null,{signup:function(e,t){return function(n){return T.post("/users",e).then(function(e){V(n,e),n(Object(W.a)("signup")),console.log("AWDAWDAWD<<<<<"),t.push("/")})}}})(oe)),se=n(31),ie=n.n(se),le=n(99),me=n.n(le),ue=n(100),pe=n.n(ue),de=n(136),he=n.n(de),ge=(n(290),function(e){var t=e.email,n=e.size,a=void 0===n?40:n,o=e.style,c=(e.user,e.image);he()(t);return r.a.createElement("img",{class:"avatar",src:c,alt:t,style:Object(m.a)({width:"".concat(a,"px"),height:"".concat(a,"px"),borderRadius:"4px"},o)})}),be=(n(291),function(e){var t=e.message,n=t.text,a=t.inserted_at,o=t.user;return r.a.createElement("div",{style:{display:"flex",marginBottom:"10px"}},r.a.createElement(ge,{email:o.email,image:o.image,style:{marginRight:"10px"}}),r.a.createElement("div",null,r.a.createElement("div",{style:{lineHeight:"1.2"}},r.a.createElement("b",{style:{marginRight:"8px",fontSize:"14px"}},o.username),r.a.createElement("time",{style:{fontSize:"12px",color:"rgb(192,192,192)"}},ie()(a).format("h:mm A"))),n.includes("giphy.com/media")?r.a.createElement("img",{src:n,style:{marginTop:"10px"}}):r.a.createElement("div",{class:"message-text"},n)))}),fe=(n(292),function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(o)))).checkShouldScroll=function(){n.stayScrolledElem&&(n.stayScrolledElem.scrollTop/(n.stayScrolledElem.scrollHeight-n.stayScrolledElem.clientHeight)>.9&&n.scrollToBottom())},n.scrollToBottom=function(){n.messagesEnd&&n.messagesEnd.scrollIntoView({behavior:"auto",block:"end"})},n.renderMessages=function(e){return e.map(function(e){return r.a.createElement(be,{key:e.id,message:e})})},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.checkShouldScroll()}},{key:"renderDays",value:function(){var e=this,t=this.props.messages;t.map(function(e){return e.day=ie()(e.inserted_at).format("MMMM Do")});var n=me()(t,"day"),a=[];pe()(n,function(e,t){a.push({date:t,messages:e})});var o=ie()().format("MMMM Do"),c=ie()().subtract(1,"days").format("MMMM Do");return a.map(function(t){return r.a.createElement("div",{className:"inner"},r.a.createElement("div",{key:t.date,className:"messages-list",ref:function(t){e.stayScrolledElem=t}},r.a.createElement("div",{className:"daydivider"},r.a.createElement("span",{className:"daytext"},t.date===o&&"Today",t.date===c&&"Yesterday",![o,c].includes(t.date)&&t.date)),e.renderMessages(t.messages),r.a.createElement("div",{style:{float:"left",clear:"both"},ref:function(t){e.messagesEnd=t}})))})}},{key:"render",value:function(){return r.a.createElement("div",{className:"messages-container"},this.renderDays())}}]),t}(a.Component)),Ee=(n(293),function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){return n.props.onSubmit(e)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this.props,t=e.handleSubmit,n=(e.submitting,e.room);return r.a.createElement("form",{onSubmit:t(this.handleSubmit),className:"message-form"},r.a.createElement("div",{className:"input-group"},r.a.createElement(L.a,{autoComplete:"off",name:"text",type:"text",component:"input",className:"form-control",placeholder:"Message "+n}),r.a.createElement("div",{className:"input-group-btn"})))}}]),t}(a.Component)),ve=Object(_.a)({form:"newMessage",validate:function(e){var t={};return e.text||(t.text="Required"),t}})(Ee),Oe=(n(294),n(137)),ye=n.n(Oe),je=n(138),Se=n.n(je),Ae=function(e){var t=e.room,n=e.users;return r.a.createElement("nav",{className:"room-navbar"},r.a.createElement("h3",null,"# ",t.name),r.a.createElement("div",{className:"navbar-subtitle"},r.a.createElement("img",{src:Se.a}),r.a.createElement("span",null," | "),r.a.createElement("img",{src:ye.a}),r.a.createElement("h4",{className:"user-count"},n.length),r.a.createElement("span",null," | ")),r.a.createElement("div",{className:"navbar-day"}))},Ce=(n(295),function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleChannelClick=function(){n.props.history.push("/")},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=(t.room,t.currentUser),a=(t.roomName,t.presentUsers),o=(t.currentUserRoomIds,t.roomList);t.onRoomJoin,t.onRoomClick;return r.a.createElement("div",{className:"room-sidebar"},r.a.createElement("div",{className:"header"},r.a.createElement("h1",null,"Slack Clone"),r.a.createElement("h2",null,n.username)),r.a.createElement("div",{className:"channels"},r.a.createElement("h2",{onClick:this.handleChannelClick},"Channels"),r.a.createElement("ul",null,o.map(function(t){return r.a.createElement("li",{key:t.id,id:t.id,className:e.props.room.id===t.id?"selected":"",onClick:e.handleClick},r.a.createElement(C.a,{to:"/r/".concat(t.id)},"# ",t.name))}))),r.a.createElement("div",{className:"users"},r.a.createElement("h2",null,"Users"),r.a.createElement("ul",null,a.map(function(e){return r.a.createElement("li",{key:e.id},r.a.createElement("span",null,e.username," "))}))))}}]),t}(a.Component)),Re=Object(c.b)(function(e){return{room:e.room.currentRoom}},{joinRoom:I})(Ce),ke=n(296)("6pnpv5D6GRVm8ZbfI6I5PQ7WRmXm4IMc"),xe=function(e){function t(){var e;return Object(f.a)(this,t),(e=Object(v.a)(this,Object(O.a)(t).call(this))).handleLoadMore=function(){return e.props.loadOlderMessages(e.props.match.params.id,{last_seen_id:e.props.messages[0].id})},e.handleMessageCreate=function(t){var n=e.props.channel,a=t.text;if("/"!==a.charAt(0))e.props.createMessage(n,t);else{a=a.substring(6);var r=e.props;ke.random(a).then(function(e){e.data.images&&(t.text=e.data.images.original.url,r.createMessage(n,t))})}},e.state={isLoading:!0},e}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){null!==this.props.socket&&this.props.connectToChannel(this.props.socket,this.props.match.params.id)}},{key:"componentDidUpdate",value:function(e){null===e.socket&&this.props.connectToChannel(this.props.socket,this.props.match.params.id),e.match.params.id!==this.props.match.params.id&&(this.props.leaveChannel(this.props.channel),this.props.connectToChannel(e.socket,this.props.match.params.id))}},{key:"componentWillUnmount",value:function(){this.props.leaveChannel(this.props.channel)}},{key:"render",value:function(){var e=this,t=this.props.pagination.total_pages>this.props.pagination.page_number;this.state.isLoading;return r.a.createElement("div",{style:{display:"flex",height:"100vh",width:"90%",minWidth:"400px"}},r.a.createElement(Re,{room:this.props.room,roomList:this.props.currentUserRooms,currentUser:this.props.currentUser,presentUsers:this.props.presentUsers,onRoomClick:this.handleRoomJoin,history:this.props.history}),r.a.createElement("div",{className:"message-window",style:{display:"flex",flexDirection:"column",width:"100%"}},r.a.createElement(Ae,{room:this.props.room,users:this.props.presentUsers}),this.props.channel?r.a.createElement(fe,{moreMessages:t,currentUser:this.props.currentUser,messages:this.props.messages,onLoadMore:this.handleLoadMore,ref:function(t){e.messageList=t},loadingOlderMessages:this.props.loadingOlderMessages}):r.a.createElement("div",null),r.a.createElement(ve,{onSubmit:this.handleMessageCreate,room:this.props.room.name?this.props.room.name:"unavailable"})))}}]),t}(a.Component),Ue=Object(c.b)(function(e){return{room:e.room.currentRoom,socket:e.session.socket,channel:e.room.channel,messages:e.room.messages,presentUsers:e.room.presentUsers,currentUser:e.session.currentUser,pagination:e.room.pagination,loadingOlderMessages:e.room.loadingOlderMessages,currentUserRooms:e.rooms.currentUserRooms}},{connectToChannel:function(e,t){return function(n){if(!e)return!1;var a=e.channel("room:".concat(t)),r={};return a.on("presence_state",function(e){r=Z.Presence.syncState(r,e),z(n,r)}),a.on("presence_diff",function(e){r=Z.Presence.syncDiff(r,e),z(n,r)}),a.on("message_created",function(e){n({type:"MESSAGE_CREATED",message:e})}),a.join().receive("ok",function(e){n({type:"ROOM_CONNECTED_TO_CHANNEL",response:e,channel:a})}),!1}},leaveChannel:function(e){return function(t){e&&e.leave(),t({type:"USER_LEFT_ROOM"})}},createMessage:function(e,t){return console.log(t),function(n){return new Promise(function(a,r){e.push("new_message",t).receive("ok",function(){return a(n(Object(W.a)("newMessage")))}).receive("error",function(){return r()})})}},loadOlderMessages:function(e,t){return function(n){return n({type:"FETCH_MESSAGES_REQUEST"}),T.fetch("/rooms/".concat(e,"/messages"),t).then(function(e){n({type:"FETCH_MESSAGES_SUCCESS",response:e})}).catch(function(){n({type:"FETCH_MESSAGES_FAILURE"})})}}})(xe),we=n(139),Ne=n.n(we),Me=k.a.create({sidebar:{display:"flex",flexDirection:"column",background:"rgb(38,0,39)"},link:{position:"relative",display:"flex",width:"65px",color:"rgba(255,255,255,.6)",":hover":{textDecoration:"none"},":focus":{textDecoration:"none"}},settingsImg:{width:"inherit",borderRadius:"10%"},activeLink:{color:"#fff",":after":{position:"absolute",top:"12px",bottom:"12px",left:"0",width:"3px",background:"rgba(255,255,255,.2)",borderTopRightRadius:"3px",borderBottomRightRadius:"3px",content:'""'}},badge:{display:"flex",alignItems:"center",justifyContent:"center",width:"45px",height:"45px",margin:"12px auto",fontSize:"20px",background:"rgba(255,255,255,.2)",borderRadius:"5px"},logoutButton:{padding:"0",background:"transparent",border:"0",cursor:"pointer"}}),Te=function(e){e.rooms;var t=e.router,n=e.onLogoutClick;return r.a.createElement("div",{className:Object(k.b)(Me.sidebar)},r.a.createElement(C.a,{to:"/",className:Object(k.b)(Me.link)},r.a.createElement("div",{className:Object(k.b)(Me.badge)},r.a.createElement("img",{src:Ne.a,className:Object(k.b)(Me.settingsImg)}),r.a.createElement("span",{className:"fa fa-plus"}))),r.a.createElement("div",{style:{flex:"1"}}),r.a.createElement("button",{onClick:function(){return n(t)},className:Object(k.b)(Me.link,Me.logoutButton)},r.a.createElement("div",{className:Object(k.b)(Me.badge)},r.a.createElement("img",{src:"http://www.logospng.com/images/61/iconfinder-iconico-by-nicolas-rubio-61578.png",className:Object(k.b)(Me.settingsImg)}),r.a.createElement("span",{className:"fa fa-sign-out"}))))},Ie=function(e){function t(){var e,n;Object(f.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(O.a)(t)).call.apply(e,[this].concat(r)))).handleLogout=function(e){return n.props.logout(e)},n}return Object(y.a)(t,e),Object(E.a)(t,[{key:"componentDidMount",value:function(){localStorage.getItem("token")?this.props.authenticate():this.props.unauthenticate()}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.currentUserRooms;return console.log("MEEEE "+t),r.a.createElement(j.a,null,r.a.createElement("div",{style:{display:"flex",flex:"1",width:"100%"}},t&&r.a.createElement(Te,{rooms:n,onLogoutClick:this.handleLogout}),r.a.createElement(S.a,{exact:!0,path:"/",component:t?B:ee}),r.a.createElement(S.a,{exact:!0,path:"/signup",component:ce}),r.a.createElement(S.a,{exact:!0,path:"/login",component:ee}),r.a.createElement(S.a,{path:"/r/:id",component:t?Ue:ee}),r.a.createElement(A.a,{component:R})))}}]),t}(a.Component),De=Object(c.b)(function(e){return{isAuthenticated:e.session.isAuthenticated,willAuthenticate:e.session.willAuthenticate,currentUserRooms:e.rooms.currentUserRooms}},{authenticate:function(){return function(e){return T.post("/sessions/refresh").then(function(t){V(e,t)}).catch(function(){localStorage.removeItem("token"),window.location="/login"})}},unauthenticate:function(){return{type:"AUTHENTICATION_FAILURE"}},logout:function(e){return function(e){return T.delete("/sessions").then(function(){localStorage.removeItem("token"),e({type:"LOGOUT"}),window.location="/"})}}})(Ie);n(299);Object(o.render)(r.a.createElement(c.a,{store:b},r.a.createElement(De,{class:"root"})),document.getElementById("root"))}},[[167,1,2]]]);
//# sourceMappingURL=main.97ba41be.chunk.js.map